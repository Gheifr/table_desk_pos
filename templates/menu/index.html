{% extends "base.html" %}
{% load static %}
{% block title %}
  <title>Menu · TableDesk POS</title>
{% endblock %}

{% block content %}
  <section class="py-4"
           style="background-image: url('{% static "img/pages-background-papyrus-cold.png" %}'); padding-bottom: 10px">

    <div class="col-12">
      <div class="row">
        {# Left navigation column #}
        <aside class="col-12 col-md-3 col-lg-2 mb-3 sticky-menu-section">
          <div class="mb-4">
            <h5 class="mb-2">Menus</h5>
            <ul class="list-group">
              {% for menu in menus %}
                <li class="list-group-item p-1">
                  <a href="{% url 'menus:index' %}?menu={{ menu.id }}"
                     class="{% if active_menu and active_menu.id == menu.id %}fw-bold{% endif %} link-body-emphasis link-offset-2 link-underline-opacity-25 link-underline-opacity-75-hover">
                    {{ menu.name }}
                  </a>
                </li>
              {% empty %}
                <li class="list-group-item">No menus defined.</li>
              {% endfor %}
            </ul>
          </div>

          <div>
            <h5 class="mb-2">Sections</h5>
            <ul class="list-group">
              {% for section in sections %}
                <li class="list-group-item p-1">
                  <a href="#{{ section }}"
                     class="link-body-emphasis link-offset-2 link-underline-opacity-25 link-underline-opacity-75-hover">{{ section|title }}</a>
                </li>
              {% empty %}
                <li class="list-group-item">No sections.</li>
              {% endfor %}
            </ul>
          </div>
        </aside>

        {# Right main #}
        <section class="col-12 col-md-9 col-lg-10 main-menu-display-section">
          {% if active_menu %}
            <div class="row align-items-center justify-content-between">
              <div class="col-9">
                <h2 class="mb-3">{{ active_menu.name }}</h2>
              </div>
              <div class="col-3 d-flex justify-content-end">
                <a href="{% url 'menus:menu-update' active_menu.pk %}" class="btn btn-outline-dark m-1">
                  Edit
                </a>
                <a href="{% url 'menus:menu-create' %}" class="btn btn-outline-dark m-1">
                  New
                </a>
              </div>
            </div>

            {% if items_by_section %}
              {% for section, items in items_by_section.items %}
                <h4 class="mt-3 mb-2" id="{{ section }}">
                  {{ section|title }}
                </h4>
                <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
                  {% for item in items %}
                    <div class="col">
                      <div class="card h-100">
                        <div class="card-body">
                          <h5 class="card-title">{{ item.name }}</h5>
                          <p class="card-text mb-1">
                            {{ item.price }} ₴
                          </p>
                          <p class="card-text">
                            <small class="text-muted">{{ item.section }}</small>
                          </p>
                        </div>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              {% endfor %}
            {% else %}
              <p>No items in this menu yet.</p>
            {% endif %}
          {% else %}
            <p>Select a menu from the list on the left.</p>
          {% endif %}
        </section>
      </div>
    </div>
  </section>
{% endblock %}
